

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to Upload PDFs and Images (pre-2.4.0) &mdash; Gini Capture SDK for Android 2.0 documentation</title>
  

  
  

  
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,400italic,600italic|Source+Code+Pro|Roboto+Slab:400,700" rel="stylesheet" type="text/css" />

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'2.0',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
    <script type="text/javascript">
        jQuery(function () {
            SphinxRtdTheme.StickyNav.enable();
        });
    </script>
  

  
    <link rel="top" title="Gini Capture SDK for Android 2.0 documentation" href="index.html"/>
        <link rel="next" title="License" href="license.html"/>
        <link rel="prev" title="Event Tracking" href="event-tracking.html"/> 

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" id="gini-logo">gini API</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference external" href="http://developer.gini.net/gini-capture-sdk-android/ginicapture/index.html">Gini Capture Javadoc</a></li>
<li class="toctree-l1"><a class="reference external" href="http://developer.gini.net/gini-capture-sdk-android/network/javadoc/index.html">Network Library Javadoc</a></li>
<li class="toctree-l1"><a class="reference external" href="http://developer.gini.net/gini-capture-sdk-android/accounting/network/javadoc/index.html">Accounting Network Library Javadoc</a></li>
<li class="toctree-l1"><a class="reference internal" href="customization-guide.html">Customization Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#onboarding-screen">Onboarding Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#action-bar">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#next-button">2. Next Button</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#page-indicators">3. Page Indicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#onboarding-message">4. Onboarding Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#onboarding-pages">5. Onboarding Pages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#camera-screen">Camera Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#camera-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#document-corner-guides">2. Document Corner Guides</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#camera-trigger-button">3. Camera Trigger Button</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#tap-to-focus-indicator">4. Tap to Focus Indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#help-menu-item">5. Help Menu Item</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#background">6. Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#document-import-button">7. Document Import Button</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#document-import-hint">8. Document Import Hint</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#images-stack">9. Images Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#qrcode-detected-popup">10. QRCode Detected Popup</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#read-storage-permission-dialogs">11. Read Storage Permission Dialogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#no-camera-permission">12. No Camera Permission</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#multi-page-limit-alert">13. Multi-Page Limit Alert</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#flash-toggle-button">14. Flash Toggle Button</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#review-screen">Review Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#review-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#review-2">2. Next Button</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#rotate-button">3. Rotate Button</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#advice">4. Advice</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#review-5">5. Background</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#analysis-screen">Analysis Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#analysis-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#activity-indicator">2. Activity Indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#pdf-info-panel">3. PDF Info Panel</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#error-snackbar">4. Error Snackbar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#analysis-5">5. Background</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#multi-page-review-screen">Multi-Page Review Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#multi-page-review-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#multi-page-review-2">2. Page Indicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#multi-page-review-3">3. Next Button</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#thumbnails-panel">4. Thumbnails Panel</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#thumbnail-card">5. Thumbnail Card</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#add-pages-card">6. Add Pages Card</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#reorder-pages-tip">7. Reorder Pages Tip</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#bottom-toolbar">8. Bottom Toolbar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#image-error">9. Image Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#imported-image-delete-last-page-dialog">10. Imported Image Delete Last Page Dialog</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#help-screen">Help Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#help-screen-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#help-screen-2">2. Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#help-list-item">3. Help List Item</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#photo-tips-screen">Photo Tips Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#photo-tips-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#photo-tips-2">2. Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#header">3. Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#tip">4. Tip</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#back-to-camera-button">5. Back To Camera Button</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#supported-formats-screen">Supported Formats Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#supported-formats-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#supported-formats-2">2. Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#supported-formats-3">3. Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#format-info-list-item">4. Format Info List Item</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#file-import-screen">File Import Screen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#file-import-1">1. Action Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#file-import-2">2. Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#file-import-3">3. Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#separator-line">4. Separator Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#section">5. Section</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#sections">6. Sections</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization-guide.html#clear-defaults-dialog">Clear Defaults Dialog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization-guide.html#message">1. Message</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="event-tracking.html">Event Tracking</a><ul>
<li class="toctree-l2"><a class="reference internal" href="event-tracking.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">How to Upload PDFs and Images (pre-2.4.0)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-considerations">General considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#registering-pdf-and-image-file-types">Registering PDF and image file types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-files-from-external-storage">Reading files from external storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handling-incoming-pdfs-and-images">Handling incoming PDFs and images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#showing-a-preview-of-the-pdfs-first-page">Showing a preview of the PDF’s first page</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="license.html#licenses-and-acknowledgements-for-incorporated-software">Licenses and Acknowledgements for Incorporated Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="license.html#apache-commons-sanselan">Apache Commons Sanselan</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html#touchimageview">TouchImageView</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html#gini-android-sdk">Gini Android SDK</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Gini Capture SDK for Android</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>How to Upload PDFs and Images (pre-2.4.0)</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="how-to-upload-pdfs-and-images-pre-2-4-0">
<h1>How to Upload PDFs and Images (pre-2.4.0)<a class="headerlink" href="#how-to-upload-pdfs-and-images-pre-2-4-0" title="Permalink to this headline">¶</a></h1>
<p>Since version 2.4.0 the <em class="xref std std-ref">File Import</em> feature should be used.</p>
<div class="section" id="general-considerations">
<h2>General considerations<a class="headerlink" href="#general-considerations" title="Permalink to this headline">¶</a></h2>
<p>Enabling your app to open PDFs and images allows your users to open any kind of files which are identified by the OS as PDFs or images. Make sure to check the MIME type and that the file size is below an acceptable threshold (5MB for example). It is also advisable to check the first bytes of the incoming files to determine their type and allow only PDFs and known image types.</p>
</div>
<div class="section" id="registering-pdf-and-image-file-types">
<h2>Registering PDF and image file types<a class="headerlink" href="#registering-pdf-and-image-file-types" title="Permalink to this headline">¶</a></h2>
<p>Add the following intent filter to the <em>Activity</em> in your <em>AndroidManifest.xml</em> you wish to receive incoming PDFs and images:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.ui.MyActivity&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter</span> <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.VIEW&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.SEND&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.DEFAULT&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;data</span> <span class="na">android:mimeType=</span><span class="s">&quot;image/*&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;data</span> <span class="na">android:mimeType=</span><span class="s">&quot;application/pdf&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We recommend adding <a class="reference external" href="https://developer.android.com/reference/android/content/Intent.html#ACTION_VIEW">ACTION_VIEW</a> to the intent filter to also allow users to send PDFs and images to your app from apps which don’t implement sharing with <a class="reference external" href="https://developer.android.com/reference/android/content/Intent.html#ACTION_SEND">ACTION_SEND</a> but enable viewing the PDF or file with other apps.</p>
</div>
<div class="section" id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://developer.android.com/training/basics/intents/filters.html">https://developer.android.com/training/basics/intents/filters.html</a></li>
</ul>
</div>
</div>
<div class="section" id="reading-files-from-external-storage">
<h2>Reading files from external storage<a class="headerlink" href="#reading-files-from-external-storage" title="Permalink to this headline">¶</a></h2>
<p>Since Android 4.4 (API Level 19) the <a class="reference external" href="https://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE">READ_EXTERNAL_STORAGE</a> permission has to be declared to access files outside of the app-specific directories. Declare this permission in your <em>AndroidManifest.xml</em>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Since the introduction of <a class="reference external" href="https://developer.android.com/training/permissions/requesting.html">Run Time Permissions</a> with Android 6.0 (API Level 23) your app also has to request permission from the user before accessing a PDF or an image file outside of the app-specific directories.</p>
<p>We recommend checking for the permission whenever your app receives a PDF or an image and before accessing it. If an explanation is requested by the system to be shown to the user we highly recommend providing one.</p>
<p>It is required to handle the case where the user did not grant permissions. We recommend showing an explanation and providing a link to your app’s <em>App info</em> page in the <em>Settings</em> app with a short guide on how to grant the permission there.</p>
<p>The Intent for opening the <em>App info</em> page can be created as follows:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">Settings</span><span class="o">.</span><span class="na">ACTION_APPLICATION_DETAILS_SETTINGS</span><span class="o">);</span>
<span class="n">Uri</span> <span class="n">uri</span> <span class="o">=</span> <span class="n">Uri</span><span class="o">.</span><span class="na">fromParts</span><span class="o">(</span><span class="n">Uri</span><span class="o">.</span><span class="s">&quot;package&quot;</span><span class="o">,</span> <span class="n">BuildConfig</span><span class="o">.</span><span class="na">APPLICATION_ID</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">uri</span><span class="o">);</span>
<span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>Documentation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://developer.android.com/training/permissions/index.html">https://developer.android.com/training/permissions/index.html</a></li>
</ul>
</div>
</div>
<div class="section" id="handling-incoming-pdfs-and-images">
<h2>Handling incoming PDFs and images<a class="headerlink" href="#handling-incoming-pdfs-and-images" title="Permalink to this headline">¶</a></h2>
<p>When your app is requested to handle a PDF or an image your <em>Activity</em> (declaring the intent filter we mentioned previously) is launched or resumed with an Intent having <tt class="docutils literal"><span class="pre">ACTION_VIEW</span></tt> or <tt class="docutils literal"><span class="pre">ACTION_SEND</span></tt>.</p>
<p>Checking whether the Intent has the required action:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">String</span> <span class="n">action</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_VIEW</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">action</span><span class="o">)</span> <span class="o">||</span> <span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_SEND</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">action</span><span class="o">))</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The Intent will contain an <tt class="docutils literal"><span class="pre">Uri</span></tt> pointing to the PDF or image. The <tt class="docutils literal"><span class="pre">Uri</span></tt> can be in the <tt class="docutils literal"><span class="pre">data</span></tt> field or since Android 4.1 (API Level 16) it can also be in the <tt class="docutils literal"><span class="pre">clipData</span></tt> field.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To also support <a class="reference external" href="https://developer.android.com/reference/android/content/Intent.html#ACTION_VIEW">ACTION_VIEW</a> we recommend using <tt class="docutils literal"><span class="pre">data</span></tt> and <tt class="docutils literal"><span class="pre">clipData</span></tt>. The <a class="reference external" href="https://developer.android.com/training/sharing/receive.html">Androd example</a> uses <tt class="docutils literal"><span class="pre">intent.getParcelableExtra(Intent.EXTRA_STREAM)</span></tt> to extract the <tt class="docutils literal"><span class="pre">Uri</span></tt>, but this works only with <a class="reference external" href="https://developer.android.com/reference/android/content/Intent.html#ACTION_SEND">ACTION_SEND</a>.</p>
</div>
<p>Getting the <tt class="docutils literal"><span class="pre">Uri</span></tt> from the Intent:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Uri</span> <span class="n">uri</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">uri</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">Build</span><span class="o">.</span><span class="na">VERSION</span><span class="o">.</span><span class="na">SDK_INT</span> <span class="o">&gt;=</span> <span class="n">Build</span><span class="o">.</span><span class="na">VERSION_CODES</span><span class="o">.</span><span class="na">JELLY_BEAN</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ClipData</span> <span class="n">clipData</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getClipData</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">clipData</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">clipData</span><span class="o">.</span><span class="na">getItemCount</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">uri</span> <span class="o">=</span> <span class="n">clipData</span><span class="o">.</span><span class="na">getItemAt</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getUri</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>We recommend checking the MIME type of Intent. The MIME type can be in the <tt class="docutils literal"><span class="pre">type</span></tt> field or since Android 4.1 (API Level 16) it can also be in the <tt class="docutils literal"><span class="pre">clipData</span></tt> field.</p>
<p>Getting the MIME type from the Intent:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mimeTypes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">String</span> <span class="n">type</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getContentResolver</span><span class="o">().</span><span class="na">getType</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">type</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getType</span><span class="o">();</span>
<span class="o">}</span>
<span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">MimeTypeMap</span><span class="o">.</span><span class="na">getFileExtensionFromUrl</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">extension</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">MimeTypeMap</span> <span class="n">mime</span> <span class="o">=</span> <span class="n">MimeTypeMap</span><span class="o">.</span><span class="na">getSingleton</span><span class="o">();</span>
        <span class="n">type</span> <span class="o">=</span> <span class="n">mime</span><span class="o">.</span><span class="na">getMimeTypeFromExtension</span><span class="o">(</span><span class="n">extension</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">mimeTypes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">type</span><span class="o">);</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">Build</span><span class="o">.</span><span class="na">VERSION</span><span class="o">.</span><span class="na">SDK_INT</span> <span class="o">&gt;=</span> <span class="n">Build</span><span class="o">.</span><span class="na">VERSION_CODES</span><span class="o">.</span><span class="na">JELLY_BEAN</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ClipData</span> <span class="n">clipData</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getClipData</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">clipData</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ClipDescription</span> <span class="n">description</span> <span class="o">=</span> <span class="n">clipData</span><span class="o">.</span><span class="na">getDescription</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">description</span><span class="o">.</span><span class="na">getMimeTypeCount</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">type</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="na">getMimeType</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">mimeTypes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">type</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Having the <tt class="docutils literal"><span class="pre">Uri</span></tt>, the contents of the PDF or image files can be read using the <tt class="docutils literal"><span class="pre">ContentResolver</span></tt>.</p>
<p>Reading the PDF or image into a byte array:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">ContentResolver</span> <span class="n">contentResolver</span> <span class="o">=</span> <span class="n">activity</span><span class="o">.</span><span class="na">getContentResolver</span><span class="o">()</span>
<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">inputStream</span> <span class="o">=</span> <span class="n">contentResolver</span><span class="o">.</span><span class="na">openInputStream</span><span class="o">(</span><span class="n">uri</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">inputStream</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ByteStreams is a utility class from Google’s Guava library</span>
        <span class="n">bytes</span> <span class="o">=</span> <span class="n">ByteStreams</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">inputStream</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">inputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The byte array from the example above can be directly uploaded to the Gini API for information extraction.</p>
<div class="section" id="id4">
<h3>Documentation<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Android: <a class="reference external" href="https://developer.android.com/training/sharing/receive.html">https://developer.android.com/training/sharing/receive.html</a></li>
<li>Gini API: <a class="reference external" href="http://developer.gini.net/gini-api/html/documents.html#submitting-files">http://developer.gini.net/gini-api/html/documents.html#submitting-files</a></li>
<li>Gini Pay API lib: <a class="reference external" href="http://developer.gini.net/gini-pay-api-lib-android/guides/common-tasks.html#upload-a-document">http://developer.gini.net/gini-pay-api-lib-android/guides/common-tasks.html#upload-a-document</a></li>
</ul>
</div>
</div>
<div class="section" id="showing-a-preview-of-the-pdfs-first-page">
<h2>Showing a preview of the PDF’s first page<a class="headerlink" href="#showing-a-preview-of-the-pdfs-first-page" title="Permalink to this headline">¶</a></h2>
<p>We recommend showing a preview of the PDF’s first page or of the image while the document is being analyzed. Rendering PDFs is possible since Android 5.0 (API Level 21). On older versions we recommend showing a placeholder image.</p>
<p>The following code shows how to generate a preview of the PDF’s first page on Android 5.0 and newer versions:</p>
<div class="highlight-java"><div class="highlight"><pre>Bitmap bitmap = null;
ContentResolver contentResolver = activity.getContentResolver();
ParcelFileDescriptor fileDescriptor = contentResolver.openFileDescriptor(uri, &quot;r&quot;);
if (fileDescriptor != null) {
    PdfRenderer pdfRenderer = new PdfRenderer(fileDescriptor);
    if (pdfRenderer != null) {
        if (pdfRenderer.getPageCount() &gt; 0) {
            PdfRenderer.Page page = pdfRenderer.openPage(0);
            // Set the width and height based on the desired preview size
            // and the aspect ratio of the pdf page
            int bitmapWidth = …;
            int bitmapHeight =  …;
            // Create a white bitmap to make sure that PDFs without
            // a background color are rendered on a white background
            int[] colors = createWhiteColorArray(bitmapWidth, bitmapHeight);
            bitmap = Bitmap.createBitmap(colors, bitmapWidth, bitmapHeight, Bitmap.Config.ARGB_8888);
            page.render(bitmap, null, null, PdfRenderer.Page.RENDER_MODE_FOR_DISPLAY);
            page.close();
        }
}
</pre></div>
</div>
<div class="section" id="id5">
<h3>Documentation<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://developer.android.com/reference/android/graphics/pdf/PdfRenderer.html">https://developer.android.com/reference/android/graphics/pdf/PdfRenderer.html</a></li>
</ul>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="license.html" class="btn btn-neutral float-right" title="License">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="event-tracking.html" class="btn btn-neutral" title="Event Tracking"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  

  
</body>
</html>